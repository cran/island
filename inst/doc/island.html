<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vicente J. Ontiveros &amp; David Alonso" />

<meta name="date" content="2020-03-18" />

<title>island: the Theory of Island Biogeography made easy</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">island: the Theory of Island Biogeography made easy</h1>
<h4 class="author">Vicente J. Ontiveros &amp; David Alonso</h4>
<h4 class="date">2020-03-18</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#the-theory-of-island-biogeography">The Theory of Island Biogeography</a></li>
<li><a href="#aims-of-this-package">Aims of this package</a></li>
</ul></li>
<li><a href="#data-entry">Data entry</a></li>
<li><a href="#likelihood-and-estimating-colonisation-and-extinction-rates">Likelihood and estimating colonisation and extinction rates</a><ul>
<li><a href="#the-equilibrium-theory-of-island-biogeography-etib">The Equilibrium Theory of Island Biogeography (ETIB)</a></li>
<li><a href="#rates-vs-transition-probabilities">Rates Vs Transition Probabilities</a></li>
</ul></li>
<li><a href="#regular-sampling-schemes">Regular sampling schemes</a><ul>
<li><a href="#estimating-colonization-and-extinction-rates">Estimating colonization and extinction rates</a></li>
<li><a href="#estimating-confidence-intervals">Estimating Confidence Intervals</a></li>
<li><a href="#likelihood-profiles">Likelihood profiles</a></li>
<li><a href="#a-few-words-on-model-selection">A few words on model selection</a></li>
<li><a href="#simulating-colonization-and-extinction-dynamics">Simulating Colonization and Extinction Dynamics</a></li>
</ul></li>
<li><a href="#irregular-sampling-schemes">Irregular Sampling Schemes</a><ul>
<li><a href="#heuristic-vs-semianalytical-methods">Heuristic Vs Semianalytical Methods</a></li>
<li><a href="#single-dataset">Single dataset</a></li>
<li><a href="#multiple-datasets">Multiple datasets</a></li>
</ul></li>
<li><a href="#a-short-example">A short example</a></li>
<li><a href="#environmental-fit">Environmental fit</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="the-theory-of-island-biogeography" class="section level2">
<h2>The Theory of Island Biogeography</h2>
<p>The Theory of Island Biogeography by MacArthur and Wilson (1967) is one of the most influential and successful theories in ecology, a rich source of inspiration for new research and ideas since it was first suggested. MacArthur and Wilson originally proposed that the number of species in an island is determined by the size of the island and its distance from the mainland. These factors result in a dynamic equilibrium between colonization from the mainland and extinction of species once they arrive on the island. The theory initially presented by MacArthur and Wilson was called ETIB (Simberloff 1974). Wilson and Simberloff’s (1969) study of the experimental defaunation of mangrove islands in the Florida Keys was the first validation of the theory, which explicitly emphasizes its dynamic aspects, and it showed how different mangrove islands reached an equilibrium with a species richness equivalent to the number of species present before the experimental defaunation.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="The classical representation of the Theory of Island Biogeography. Islands further from the mainland receive less species than closer ones, and there are more extinctions on small islands than on the large ones. The number of species at equilibrium corresponds to the point where colonization equals extinction." />
<p class="caption">
The classical representation of the Theory of Island Biogeography. Islands further from the mainland receive less species than closer ones, and there are more extinctions on small islands than on the large ones. The number of species at equilibrium corresponds to the point where colonization equals extinction.
</p>
</div>
<p>The package <code>island</code> follows the stochastic implementation of Simberloff’s model (1969) developed by Alonso <em>et al.</em> (2015), that uses a likelihood approach to estimate colonization and extinction rates for communities that have been repeatedly sampled through time.</p>
</div>
<div id="aims-of-this-package" class="section level2">
<h2>Aims of this package</h2>
<p>This package allows:<br />
1. Estimating colonization and extinction rates with regular and irregular sampling schemes, for whole communities or groups within those communities, taking into account or not imperfect detectability.<br />
2. Converting those rates into transition probabilities.<br />
3. Performing Akaike Information Criterion (AIC) -based model selection.<br />
4. Estimating the influence of environmental variables on colonization and extinction dynamics.<br />
5. Simulating the dynamics of the Equilibrium Theory of Island Biogeography, as well as three other population models.<br />
6. Evaluating model error and R².</p>
</div>
</div>
<div id="data-entry" class="section level1">
<h1>Data entry</h1>
<p>In order to estimate colonization and extinction rates with package <code>island</code>, we need a dataframe of repeatedly sampled communities, organised in time and with at least one species (or the relevant taxonomic unit for our analysis). In this package we adopt the convention of indicating sampling times in columns and species in rows of the dataframe. As an example, take a look at the dataframe <code>data(alonso15)</code>, that uses a regular sampling scheme for 4 years (2000 to 2003).</p>
<table>
<thead>
<tr class="header">
<th align="left">Species</th>
<th align="left">Trophic.Level</th>
<th align="right">Kd.2000</th>
<th align="right">Kd.2001</th>
<th align="right">Kd.2002</th>
<th align="right">Kd.2003</th>
<th align="right">Kd.2010</th>
<th align="right">Kd.2011</th>
<th align="left">Guild</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Acanthurus auranticavus</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="even">
<td align="left">Acanthurus leucosternon</td>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="odd">
<td align="left">Acanthurus lineatus</td>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="even">
<td align="left">Acanthurus nigrofuscus</td>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="odd">
<td align="left">Acanthurus triostegus</td>
<td align="left">2,78</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="even">
<td align="left">Acanthurus xanthopterus</td>
<td align="left">2,87</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
</tbody>
</table>
<p>In the case of irregular sampling schemes, we adopt a convention of recording subsequent time intervals in the column header. For example, if our sampling started on day 17, and the next sample was taken 20 days after, that is, on day 37, the column heads for those samples should read 17 and 37. These conventions have been followed in <code>data(simberloff)</code>, extracted here:</p>
<table>
<thead>
<tr class="header">
<th align="left">Taxa</th>
<th align="right">PRE</th>
<th align="right">31</th>
<th align="right">51</th>
<th align="right">69</th>
<th align="right">258</th>
<th align="right">276</th>
<th align="right">295</th>
<th align="right">371</th>
<th align="left">Tax. Unit 1</th>
<th align="left">Tax. Unit 2</th>
<th align="left">Genera</th>
<th align="left">Island</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Gen. Sp.</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Embioptera</td>
<td align="left">Teratembiidae</td>
<td align="left">Unknown</td>
<td align="left">E2</td>
</tr>
<tr class="even">
<td align="left">Aglaopteryx sp.</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Orthoptera</td>
<td align="left">Blattidae</td>
<td align="left">Aglaopteryx</td>
<td align="left">E2</td>
</tr>
<tr class="odd">
<td align="left">Latiblattella n. sp.</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Orthoptera</td>
<td align="left">Blattidae</td>
<td align="left">Latiblattella</td>
<td align="left">E2</td>
</tr>
<tr class="even">
<td align="left">Latiblattella rehni</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Orthoptera</td>
<td align="left">Blattidae</td>
<td align="left">Latiblattella</td>
<td align="left">E2</td>
</tr>
<tr class="odd">
<td align="left">Cycloptilum sp.</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Orthoptera</td>
<td align="left">Gryllidae</td>
<td align="left">Cycloptilum</td>
<td align="left">E2</td>
</tr>
<tr class="even">
<td align="left">Cyrtoxipha sp.</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Orthoptera</td>
<td align="left">Gryllidae</td>
<td align="left">Cyrtoxipha</td>
<td align="left">E2</td>
</tr>
</tbody>
</table>
<p>In both examples, we can see that we have columns for the taxa (or species) studied, some columns with additional information (such as Guild or Taxonomic Unit considered), and consecutive columns with data on presence (1) or absence (0).<br />
Studying ecological communities can be messy. Temporal studies that track changes over many sites may often result in sampling schemes that are irregular both in time and space. In cases where we have different sampling schemes in our data, we require the different sampling schemes to be treated as different dataframes inside a list. An example would be the data set <code>simberloff</code>.</p>
</div>
<div id="likelihood-and-estimating-colonisation-and-extinction-rates" class="section level1">
<h1>Likelihood and estimating colonisation and extinction rates</h1>
<div id="the-equilibrium-theory-of-island-biogeography-etib" class="section level2">
<h2>The Equilibrium Theory of Island Biogeography (ETIB)</h2>
The seminal work of Wilson &amp; Simberloff (1969) on the experimental defaunation of mangrove islands in the Florida Keys was the first experimental validation of the ETIB, that predicted that colonization and extinction on an island would balance out and reach a dynamic equilibrium. The basic model underlying the theory can be expressed as follows: <span class="math display">\[ \frac{dS_s}{dt} = c(S_P - S_s) - eS_s \]</span> where <span class="math inline">\(S_s\)</span> is the number of species present at a site, <span class="math inline">\(S_P\)</span> is the number of species in the regional pool, and <span class="math inline">\(c\)</span> and <span class="math inline">\(e\)</span> are colonization and extinction rates respectively. This model states that the temporal variation in the number of species in a site over time is equal to the total rate of arrival of species from the pool that are not already at the site minus the total rate of species loss from the site. The equation can be easily solved for a single species and we can compute the probability of a species being present or absent at any time (see Alonso <em>et al.</em> 2015). With these probabilities we can construct a matrix of transition probabilities for the associated Markov model:
<span class="math display">\[\begin{equation}
  \label{T_00}
  \left\{
    \begin{array}{ccc}      
      T_{00} &amp;=&amp;  1 - \frac{c}{e+c} ( 1 - \exp(-(e+c)\Delta t))\\
      
      T_{10} &amp;=&amp;  \frac{c}{e+c} ( 1 - \exp(-(e+c)\Delta t) )\\  
      
      T_{01} &amp;=&amp;  \frac{e}{e+c} ( 1 - \exp(-(e+c)\Delta t) ) \\
      
      T_{11} &amp;=&amp;  1 - \frac{e}{e+c} ( 1 - \exp(-(e+c)\Delta t)) 
    \end{array}
  \right.
\end{equation}\]</span>
where <span class="math inline">\(T_{01}\)</span> is the probability of extinction, <span class="math inline">\(T_{10}\)</span> the probability of colonization, <span class="math inline">\(T_{11}\)</span> of repeated presence and <span class="math inline">\(T_{00}\)</span> of repeated absence. Two key assumptions, the assumption of <em>species equivalence</em> (the same parameters apply for a group of species), and the assumption of <em>species independence</em> (the presence of other species does not affect the dynamics of a focal species), allow to generalize this Markov process to groups of species or even communities. We can therefore calculate the likelihood of a given data set under the colonization-extinction model with the following expression for a regular sampling scheme given specific colonization and extinction rates, <em>c</em> and <em>e</em>:
<span class="math display">\[\begin{equation}
  P( M | c, e) = (1-T_{10})^{N_{00}} T_{10}^{N_{10}} T_{01}^{N_{01}} (1-T_{01})^{N_{11}}
\end{equation}\]</span>
<p>where <span class="math inline">\(N_{00}\)</span> is the number of events of repeated absence, <span class="math inline">\(N_{10}\)</span> events of colonization, <span class="math inline">\(N_{01}\)</span> events of extinction and <span class="math inline">\(N_{11}\)</span> events of repeated presence. In the case of an irregular sampling scheme we need to calculate the transition probabilities and the matching likelihood for each transition.<br />
As an example, imagine that we have sampled arthropods on an island for three seasons and we have the following data:</p>
<table>
<thead>
<tr class="header">
<th align="left">Sp.</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">G</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">H</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">I</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">J</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Here we can see that between samples 1 and 2 we have <span class="math inline">\(N_{01} = 1\)</span> (G), <span class="math inline">\(N_{11} = 2\)</span> (C, I), <span class="math inline">\(N_{00} = 5\)</span> (A, D, F, H, J), and <span class="math inline">\(N_{10} = 2\)</span> (B, E); we can similarly calculate transitions between samples 2 and 3. Assuming we already know the true value of transition probabilities (<span class="math inline">\(T_{01} = 0.4\)</span>, <span class="math inline">\(T_{11} = 0.6\)</span>, <span class="math inline">\(T_{00} = 0.7\)</span> and <span class="math inline">\(T_{10} = 0.3\)</span>), we can easily calculate the likelihood of the observed dataframe above as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### LIKELIHOOD
<span class="fl">0.4</span><span class="op">^</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.6</span><span class="op">^</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.7</span><span class="op">^</span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.3</span><span class="op">^</span><span class="dv">3</span>
<span class="co">#&gt; [1] 6.325999e-06</span>
<span class="co"># This is a pretty small likelihood. We can easily transform this likelihood into log-likelihood.</span>

### LOG-LIKELIHOOD
<span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="fl">0.4</span>) <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="fl">0.3</span>)
<span class="co">#&gt; [1] -11.97084</span>
<span class="co"># This is the log-likelihood associated with the given set of transition probabilities. Notice that we obtain the same value with both approaches.</span>
<span class="kw">log</span>(<span class="fl">0.4</span><span class="op">^</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.6</span><span class="op">^</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.7</span><span class="op">^</span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.3</span><span class="op">^</span><span class="dv">3</span>)
<span class="co">#&gt; [1] -11.97084</span></code></pre></div>
<p>The method above allows us to calculate the likelihood of our data set from known transition probabilities. However, say that we do not know the transition probabilities and want to estimate them. We can do this easily with the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c_and_e &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>)
c_and_e
<span class="co">#&gt;           c c_up c_low        e e_up e_low  N      NLL</span>
<span class="co">#&gt; 1 0.3769053   NA    NA 0.699967   NA    NA 10 11.80301</span></code></pre></div>
<p>This gives us the rates <span class="math inline">\(c\)</span> and <span class="math inline">\(e\)</span>, but where are the transition probabilities? We obtain them with the function <code>cetotrans</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cetotrans</span>(<span class="dt">c =</span> c_and_e[<span class="dv">1</span>], <span class="dt">e =</span> c_and_e[<span class="dv">4</span>])
<span class="co">#&gt;      T01       T10      </span>
<span class="co">#&gt; [1,] 0.4285714 0.2307692</span></code></pre></div>
<p>The equations <span class="math inline">\(T_{11}= 1 - T_{01}\)</span> and <span class="math inline">\(T_{00} = 1 - T_{10}\)</span> will give us a complete set of transition probabilities estimated from the data.</p>
</div>
<div id="rates-vs-transition-probabilities" class="section level2">
<h2>Rates Vs Transition Probabilities</h2>
<p>There are two main differences between transition probabilities and rates. First, transition probabilities are dimensionless numbers, while rates have dimensions of time<span class="math inline">\(^{-1}\)</span>. Second, with rates we can directly estimate the transition probabilities for any time interval, while transition probabilities are associated with a specific time interval, so if we have <span class="math inline">\(T_{10}=0.6\)</span> for a specific time interval and we need the transition probability for twice that interval <span class="math inline">\(T_{10}' \ne 2 \times 0.6\)</span> but if a colonization rate per week is <span class="math inline">\(c = 0.6 \ week^{-1}\)</span> the colonization rate after 2 weeks would be <span class="math inline">\(c' = 2 \ weeks \times 0.6 \ week^{-1}= 1.2\)</span>. This property allows us to work with irregular sampling schemes —much more common in ecology than regular ones— naturally, simply using a pair of colonization and extinction rates.</p>
</div>
</div>
<div id="regular-sampling-schemes" class="section level1">
<h1>Regular sampling schemes</h1>
<p>The ideal scenario for ecological studies is one in which we sample our subject of study (say the community of fishes on an coral reef) regularly and frequently enough to observe changes in the community. Even though this is rare in ecology, this facilitates the estimation of rates and is less computationally intense. The estimation of rates for these regular sampling schemes has an analytically exact expression, while for irregular sampling schemes we need to rely on heuristic methods or numerical solvers (see section Irregular Sampling Schemes).<br />
Throughout this section, we will use <code>data(alonso15)</code>, a data set of three lists that have information on presence-absence of the community of coral reef fish communities in atolls in the Lakshadweep Archipelago (India). We will use data only from one of the atolls, Kadmat. The table below is an extract of the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;alonso15&quot;</span>)
df &lt;-<span class="st"> </span>alonso15[[<span class="dv">2</span>]]
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(df))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Species</th>
<th align="left">Trophic.Level</th>
<th align="right">Kd.2000</th>
<th align="right">Kd.2001</th>
<th align="right">Kd.2002</th>
<th align="right">Kd.2003</th>
<th align="right">Kd.2010</th>
<th align="right">Kd.2011</th>
<th align="left">Guild</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Acanthurus auranticavus</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="even">
<td align="left">Acanthurus leucosternon</td>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="odd">
<td align="left">Acanthurus lineatus</td>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="even">
<td align="left">Acanthurus nigrofuscus</td>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="odd">
<td align="left">Acanthurus triostegus</td>
<td align="left">2,78</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
<tr class="even">
<td align="left">Acanthurus xanthopterus</td>
<td align="left">2,87</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Algal Feeder</td>
</tr>
</tbody>
</table>
<p>We have several columns of data. The first column of the data.frame lists the species studied, while the second, its associated trophic level. The third to the eighth columns contain presence-absence data of temporal samples collected in consecutive years between 2000 to 2003 and once again in 2010-2011. Finally, the last column has data on the guild of the species studied. For example, the third entry in the data.frame has data for <em>Acanthurus lineatus</em>, an algal feeder present in all the years studied.</p>
<div id="estimating-colonization-and-extinction-rates" class="section level2">
<h2>Estimating colonization and extinction rates</h2>
<p>From here, we can start estimating colonization and extinction rates for the entire community using the function <code>regular_sampling_scheme</code>. First, we have to specify a single data.frame in the function using argument <code>x =</code> and the name of our data.frame. Next, we need to tell the function in which columns the presence-absence data located with the argument <code>vector =</code>, in this case, columns 3 to 6. We will not use the data from 2010 and 2011. So let’s estimate the colonization and extinction rates:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)
rates
<span class="co">#&gt;           c c_up c_low         e e_up e_low   N     NLL</span>
<span class="co">#&gt; 1 0.6034534   NA    NA 0.3505777   NA    NA 156 276.576</span></code></pre></div>
<p>As we can see the colonization rate is <em>c = 0.603</em> and the extinction rate <em>e = 0.351</em>. In addition, the output of the function tells us that we have examined 156 species and that the Negative Log-Likelihood of this model is <em>NLL = 276.576</em>.<br />
What if we want to know the rates for each guild? We just have to add to the call the argument <code>level</code>, as in <code>level = &quot;Guild&quot;</code>, indicating the name of the column that divides the data into groups, and <code>n</code>, as in <code>n = 5</code> indicating the minimum number of species that a group needs in order to estimate its rates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates_g &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">level =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">5</span>)
rates_g
<span class="co">#&gt;               Group         c c_up c_low          e e_up e_low  N      NLL</span>
<span class="co">#&gt; 1      Algal Feeder 0.7685355   NA    NA 0.16302269   NA    NA 30 38.95667</span>
<span class="co">#&gt; 2       Corallivore 0.4427195   NA    NA 0.39352848   NA    NA 20 35.72338</span>
<span class="co">#&gt; 3 Macroinvertivore  1.0151676   NA    NA 0.56465265   NA    NA 41 78.09438</span>
<span class="co">#&gt; 4  Microinvertivore 0.4960388   NA    NA 0.51204007   NA    NA 21 39.36755</span>
<span class="co">#&gt; 5         Omnivore  0.5090504   NA    NA 0.40724033   NA    NA  9 16.33690</span>
<span class="co">#&gt; 6        Piscivore  0.5263375   NA    NA 0.60002472   NA    NA 21 40.03434</span>
<span class="co">#&gt; 7   Zooplanktivore  0.5124767   NA    NA 0.09189237   NA    NA 14 15.93931</span></code></pre></div>
<p>This calculates the colonization and extinction rates for each guild separately, e.g. corallivores or piscivores, as well as the number of species in each guild and the negative log-likelihood associated with these rates and data.</p>
</div>
<div id="estimating-confidence-intervals" class="section level2">
<h2>Estimating Confidence Intervals</h2>
<p>The estimates of colonization and extinction rates can not be regarded as fixed values, but have an associated uncertainty due, at least in part, to the amount of data we use to calculate the estimates. In interpreting these results we recommend to calculate confidence intervals for the rates we have just estimated. Confidence intervals can be calculated using function <code>regular_sampling_scheme</code> with the argument <code>CI = T</code>. This option provides confidence intervals whose limits have a difference in log-likelihood of 1.96 units around the estimator.<br />
We employ two separate methods to estimate confidence intervals: a sequential method, which is computationally expensive, and a binary search seeded with the Hessian of the likelihood function. The rationale of the sequential method is the following: we start from one of the parameters, say <em>c</em>, and we sequentially add a small amount <code>step</code> to the parameter, obtaining the log-likelihood of the new value of the parameter, <em>c’</em>, until the difference in log-likelihood between <em>c</em> and <em>c’</em> climbs above 1.96. This gives us the upper boundary of <em>c</em>. The lower boundary is calculated similarly, but with sequential subtraction. This is a straightforward method, but it has to balance computational time and accuracy with the size of the interval <code>step</code>.<br />
The alternative method uses the Hessian of the likelihood function as a seed for a binary search to determine the intervals. After some algebra, the Hessian provides an asymptotic estimator of the confidence interval, thus being a good starting point to look for the actual interval. The method works by calculating the likelihood of this asymptotic estimator and expanding the search (if the difference with our estimate is less than 1.96) or narrowing it (if it is greater than 1.96). This method typically finds the confidence interval in about 10 steps, and is significantly less computationally intense than the sequential method. However, in some cases, the value of the Hessian reduces almost to zero or produces a non-invertible matrix. In these cases, we recommend using argument <code>step</code>.<br />
Coming back to our example, we can calculate confidence intervals either for the entire community or for each studied guilds:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates2a &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">CI =</span> T)
rates2a
<span class="co">#&gt;           c      c_up     c_low         e      e_up     e_low   N     NLL</span>
<span class="co">#&gt; 1 0.6034534 0.7527623 0.4763309 0.3505777 0.4483115 0.2686129 156 276.576</span>

<span class="co"># Sequential method</span>
rates2b &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">level =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">step =</span> <span class="fl">0.005</span>, <span class="dt">CI =</span> T)
knitr<span class="op">::</span><span class="kw">kable</span>(rates2b)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="right">c</th>
<th align="right">c_up</th>
<th align="right">c_low</th>
<th align="right">e</th>
<th align="right">e_up</th>
<th align="right">e_low</th>
<th align="right">N</th>
<th align="right">NLL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Algal Feeder</td>
<td align="right">0.7685355</td>
<td align="right">1.3135355</td>
<td align="right">0.4035355</td>
<td align="right">0.1630227</td>
<td align="right">0.3230227</td>
<td align="right">0.0680227</td>
<td align="right">30</td>
<td align="right">38.95667</td>
</tr>
<tr class="even">
<td align="left">Corallivore</td>
<td align="right">0.4427195</td>
<td align="right">0.8127195</td>
<td align="right">0.2077195</td>
<td align="right">0.3935285</td>
<td align="right">0.7485285</td>
<td align="right">0.1735285</td>
<td align="right">20</td>
<td align="right">35.72338</td>
</tr>
<tr class="odd">
<td align="left">Macroinvertivore</td>
<td align="right">1.0151676</td>
<td align="right">1.5001676</td>
<td align="right">0.6601676</td>
<td align="right">0.5646527</td>
<td align="right">0.8546527</td>
<td align="right">0.3496527</td>
<td align="right">41</td>
<td align="right">78.09438</td>
</tr>
<tr class="even">
<td align="left">Microinvertivore</td>
<td align="right">0.4960388</td>
<td align="right">0.8910388</td>
<td align="right">0.2410388</td>
<td align="right">0.5120401</td>
<td align="right">0.9170401</td>
<td align="right">0.2520401</td>
<td align="right">21</td>
<td align="right">39.36755</td>
</tr>
<tr class="odd">
<td align="left">Omnivore</td>
<td align="right">0.5090504</td>
<td align="right">1.2240504</td>
<td align="right">0.1540504</td>
<td align="right">0.4072403</td>
<td align="right">0.9772403</td>
<td align="right">0.1222403</td>
<td align="right">9</td>
<td align="right">16.33690</td>
</tr>
<tr class="even">
<td align="left">Piscivore</td>
<td align="right">0.5263375</td>
<td align="right">0.9063375</td>
<td align="right">0.2763375</td>
<td align="right">0.6000247</td>
<td align="right">1.1000247</td>
<td align="right">0.2850247</td>
<td align="right">21</td>
<td align="right">40.03434</td>
</tr>
<tr class="odd">
<td align="left">Zooplanktivore</td>
<td align="right">0.5124767</td>
<td align="right">1.1274767</td>
<td align="right">0.1774767</td>
<td align="right">0.0918924</td>
<td align="right">0.2918924</td>
<td align="right">0.0118924</td>
<td align="right">14</td>
<td align="right">15.93931</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Hessian-based method</span>
rates2c &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">level =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">CI =</span> T)
knitr<span class="op">::</span><span class="kw">kable</span>(rates2c)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="right">c</th>
<th align="right">c_up</th>
<th align="right">c_low</th>
<th align="right">e</th>
<th align="right">e_up</th>
<th align="right">e_low</th>
<th align="right">N</th>
<th align="right">NLL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Algal Feeder</td>
<td align="right">0.7685355</td>
<td align="right">1.3122641</td>
<td align="right">0.4078379</td>
<td align="right">0.1630227</td>
<td align="right">0.3195759</td>
<td align="right">0.0690967</td>
<td align="right">30</td>
<td align="right">38.95667</td>
</tr>
<tr class="even">
<td align="left">Corallivore</td>
<td align="right">0.4427195</td>
<td align="right">0.8123286</td>
<td align="right">0.2101798</td>
<td align="right">0.3935285</td>
<td align="right">0.7439781</td>
<td align="right">0.1778156</td>
<td align="right">20</td>
<td align="right">35.72338</td>
</tr>
<tr class="odd">
<td align="left">Macroinvertivore</td>
<td align="right">1.0151676</td>
<td align="right">1.4990009</td>
<td align="right">0.6626292</td>
<td align="right">0.5646527</td>
<td align="right">0.8532916</td>
<td align="right">0.3539581</td>
<td align="right">41</td>
<td align="right">78.09438</td>
</tr>
<tr class="even">
<td align="left">Microinvertivore</td>
<td align="right">0.4960388</td>
<td align="right">0.8864932</td>
<td align="right">0.2458565</td>
<td align="right">0.5120401</td>
<td align="right">0.9149993</td>
<td align="right">0.2538674</td>
<td align="right">21</td>
<td align="right">39.36755</td>
</tr>
<tr class="odd">
<td align="left">Omnivore</td>
<td align="right">0.5090504</td>
<td align="right">1.2212077</td>
<td align="right">0.1557325</td>
<td align="right">0.4072403</td>
<td align="right">0.9772242</td>
<td align="right">0.1240222</td>
<td align="right">9</td>
<td align="right">16.33690</td>
</tr>
<tr class="even">
<td align="left">Piscivore</td>
<td align="right">0.5263375</td>
<td align="right">0.9051379</td>
<td align="right">0.2774242</td>
<td align="right">0.6000247</td>
<td align="right">1.0951876</td>
<td align="right">0.2879977</td>
<td align="right">21</td>
<td align="right">40.03434</td>
</tr>
<tr class="odd">
<td align="left">Zooplanktivore</td>
<td align="right">0.5124767</td>
<td align="right">1.1233754</td>
<td align="right">0.1808364</td>
<td align="right">0.0918924</td>
<td align="right">0.2884887</td>
<td align="right">0.0148875</td>
<td align="right">14</td>
<td align="right">15.93931</td>
</tr>
</tbody>
</table>
<p>As we can see, when the number of species in a group is low, uncertainty increases and expands the confidence intervals. In addition, the differences between the two methods are negligible in their output, except for the computational time needed.</p>
</div>
<div id="likelihood-profiles" class="section level2">
<h2>Likelihood profiles</h2>
<p>A likelihood profile is a simple way to bound the confidence interval of a parameter. Our sequential procedure is clearly based on likelihood profiles, and we will illustrate it using the function <code>NLL_rss</code>, that calculates the NLL of a model given its parameters. There are equivalent functions, <code>NLL_isd</code>, <code>NLL_imd</code> and <code>NLL_env</code> that produce the equivalent output with different sampling schemes or environmental influences on the parameters.<br />
Next, for our case study, we will calculate the likelihood profile for colonization in Kadmat atoll. Function <code>NLL_rss</code> needs a dataframe <code>x</code>, a <code>vector</code> with the number of the columns to analyze, and given <code>c</code> and <code>e</code> rates. The procedure iteratively calculates the likelihood of the parameter given the data around the estimated value. The shape of the likelihood profile gives us an indication on how peaked around the maximum our likelihood functions are.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates
<span class="co">#&gt;           c c_up c_low         e e_up e_low   N     NLL</span>
<span class="co">#&gt; 1 0.6034534   NA    NA 0.3505777   NA    NA 156 276.576</span>

seqs &lt;-<span class="st"> </span><span class="kw">seq.int</span>(<span class="dv">5</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">5</span>) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>
NLLs &lt;-<span class="st"> </span><span class="kw">NLL_rss</span>(<span class="dt">x =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">c =</span> seqs <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>c, <span class="dt">e =</span> rates<span class="op">$</span>e)
<span class="kw">plot</span>(seqs <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>c, NLLs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Colonization rate (year⁻¹)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Negative Log-Likelihood&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Likelihood profile&quot;</span>)
<span class="kw">points</span>(rates<span class="op">$</span>c, rates<span class="op">$</span>NLL, <span class="dt">pch =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;magenta&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Likelihood profile for the colonization rate in Kadmat atoll. The cross in magenta indicates the m.l.e. for the rate." />
<p class="caption">
Likelihood profile for the colonization rate in Kadmat atoll. The cross in magenta indicates the m.l.e. for the rate.
</p>
</div>
</div>
<div id="a-few-words-on-model-selection" class="section level2">
<h2>A few words on model selection</h2>
<p>Model selection identifies the best model that fits a given data set. In this package we propose the use of the <em>Akaike Information Criterion</em> (AIC) and the associated measure of <em>weight of evidence</em> to choose the model that best fits the data and compares it against several alternative models. The functions in package <code>island</code> provide Negative Log-Likelihoods (NLLs) that can easily be transformed to AIC with functions <code>akaikeic</code> or <code>akaikeicc</code>. We can then calculate the <code>weight_of_evidence</code> for each competing model that potentially explains our observations. As a reminder, AICs are only comparable when we try to explain the same data with different models, because it makes no sense comparing the AIC of two different data sets with the same model, since the data is different in both cases.<br />
Let us compare two competing models that try to explain the same data. We will use the data for Kadmat once again, to check if the model that treats each guild’s dynamics separately better explains the data than the model that works with a single colonization and extinction pair of rates for the entire assemblage. For this, we will extract the NLL of both models, calculate their AIC using function <code>akaikeic</code>, and compare the results with function <code>weight_of_evidence</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">guild_NLL &lt;-<span class="st"> </span><span class="kw">sum</span>(rates2c<span class="op">$</span>NLL)
guild_NLL
<span class="co">#&gt; [1] 264.4525</span>
comm_NLL &lt;-<span class="st"> </span>rates<span class="op">$</span>NLL
comm_NLL
<span class="co">#&gt; [1] 276.576</span>

aic_g &lt;-<span class="st"> </span><span class="kw">akaikeic</span>(<span class="dt">NLL =</span> guild_NLL, <span class="dt">k =</span> <span class="dv">14</span>)
aic_c &lt;-<span class="st"> </span><span class="kw">akaikeic</span>(<span class="dt">NLL =</span> comm_NLL, <span class="dt">k =</span> <span class="dv">2</span>)
aic_g
<span class="co">#&gt; [1] 556.905</span>
aic_c
<span class="co">#&gt; [1] 557.1519</span>

ms_kadmat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Model =</span> <span class="kw">c</span>(<span class="st">&quot;Guilds&quot;</span>, <span class="st">&quot;Community&quot;</span>), <span class="dt">AIC =</span> <span class="kw">c</span>(aic_g, aic_c))
<span class="kw">weight_of_evidence</span>(<span class="dt">data =</span> ms_kadmat)
<span class="co">#&gt;       Model   IncAIC         w</span>
<span class="co">#&gt; 1    Guilds 0.000000 0.5308212</span>
<span class="co">#&gt; 2 Community 0.246883 0.4691788</span></code></pre></div>
<p>The output indicates that the log-likelihood of the model with different dynamics for each guild is over 12 points better than the model with a single dynamic group, which means that considering the guilds separately better explains the data than lumping together all guilds in a single group. However, the “guilds” model has 14 parameters while the “community” model has only 2. It is unsurprising that the more parameters the model has, the better it explains the data. For this reason, we calculate the AIC of each model using function <code>akaikeic</code>, that, to preserve parsimony, accounts for the number of parameters with the argument <code>k</code>. AIC values suggest that the “guilds” model is only marginally better than the “community” model, with a difference of 0.25. This is a tiny difference, and we cannot conclusively say that one of the models has more support than the other. This analysis is backed by the function <code>weight_of_evidence</code>, that provides a measure of the support that each of the competing models has. We found that the “guilds” model has a weight of evidence of 53% while the “community” model is 47% and, as already noted, we cannot conclude that any model is significantly better. We will explore this dataset in some more detail in the section <em>A short example</em>.</p>
</div>
<div id="simulating-colonization-and-extinction-dynamics" class="section level2">
<h2>Simulating Colonization and Extinction Dynamics</h2>
<p>The package <code>island</code> allows to simulate ecological data driven by colonization and extinction dynamics. Functions <code>data_generation</code> and <code>PA_simulation</code> allow us to generate species richness or presence-absence data from an initial vector of presence-absence for specific transition probabilities that can vary between different simulated transitions. As an example, we will simulate the temporal evolution in richness for Kadmat atoll.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### First, take a look at the rates for Kadmat
tp &lt;-<span class="st"> </span><span class="kw">cetotrans</span>(<span class="dt">c =</span> rates<span class="op">$</span>c, <span class="dt">e =</span> rates<span class="op">$</span>e)

<span class="kw">set.seed</span>(<span class="dv">10110111</span>)
sim_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">PA_simulation</span>(<span class="dt">x =</span> df, <span class="dt">column =</span> <span class="dv">3</span>, <span class="dt">transitions =</span> tp, <span class="dt">times =</span> <span class="dv">11</span>)
<span class="kw">colSums</span>(sim_<span class="dv">1</span>)
<span class="co">#&gt;  [1]  88  88 100 106 100 103  98  97 102  99 101</span>

sims &lt;-<span class="st"> </span><span class="kw">data_generation</span>(<span class="dt">x =</span> df, <span class="dt">column =</span> <span class="dv">3</span>, <span class="dt">transitions =</span> tp, <span class="dt">iter =</span> <span class="dv">999</span>, <span class="dt">times =</span> <span class="dv">11</span>)
sims[, <span class="dv">1</span>]
<span class="co">#&gt;  [1]  85  98  91  97 102  97  92  93  96 100 102</span>

ic &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> sims, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> quantile, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
ic
<span class="co">#&gt;       [,1]   [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]</span>
<span class="co">#&gt; 2.5%    80  83.95   85   86   87   86   87   87   87    87    86</span>
<span class="co">#&gt; 97.5%  102 107.00  109  109  109  110  109  109  110   109   110</span>
rates 
<span class="co">#&gt;           c c_up c_low         e e_up e_low   N     NLL</span>
<span class="co">#&gt; 1 0.6034534   NA    NA 0.3505777   NA    NA 156 276.576</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Temporal evolution in Kadmat atoll. The points connected with lines indicate the observed species richness, while the red dashed line indicates the 95% distribution of simulations. The dotted black line corresponds to one stochastic simulation of the colonization and extinction dynamics on the atoll." />
<p class="caption">
Temporal evolution in Kadmat atoll. The points connected with lines indicate the observed species richness, while the red dashed line indicates the 95% distribution of simulations. The dotted black line corresponds to one stochastic simulation of the colonization and extinction dynamics on the atoll.
</p>
</div>
<p>In the simulation above, we use colonization and extinction rates estimated with the first 4 samples to simulate community dynamics from 2000 to 2011. We can use this to evaluate how reliably our parameter estimates of colonization-extinction dynamics fit observed data. The plot above shows the actual observations, the result of a simulation (as a black dotted line) and the 95% distribution of the simulations of the dynamics (the area enclosed within the two red dashed lines). The actual data falls well within the boundaries delimited by the simulation except for the last sample.<br />
Finally, we will estimate goodness-of-fit calculating model R^2. Any estimation of R^2 requires a null model to compare with. R^2 measures how well our model performs in relation to a null model of choice. As a null model, here we assume that at any given time we can have a number of species present from 0 to <span class="math inline">\(S_P\)</span>, the number of species in the pool, which is drawn from a uniform probability distribution. In order to estimate goodness-of-fit, we use the function <code>r_squared</code>, which requires us to specify the <code>observed</code> species richness, <code>simulated</code> species richness and the number of species in the pool <code>sp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simulated &lt;-<span class="st"> </span><span class="kw">apply</span>(sims, <span class="dv">1</span>, quantile, <span class="fl">0.5</span>)
simulated 
<span class="co">#&gt;  [1] 91 96 97 98 99 98 99 98 98 99 99</span>

simulated &lt;-<span class="st"> </span>simulated[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">11</span>)]

observed &lt;-<span class="st"> </span><span class="kw">colSums</span>(df[, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>])
observed
<span class="co">#&gt; Kd.2000 Kd.2001 Kd.2002 Kd.2003 Kd.2010 Kd.2011 </span>
<span class="co">#&gt;      79      91     100      95     103     120</span>

<span class="co"># We skip the first observation since we have to use it as the starting point of the simulations.</span>
observed &lt;-<span class="st"> </span>observed[<span class="op">-</span><span class="dv">1</span>] 

<span class="kw">r_squared</span>(<span class="dt">observed =</span> observed, <span class="dt">simulated =</span> simulated, <span class="dt">sp =</span> <span class="dv">156</span>)
<span class="co">#&gt; R-Squared </span>
<span class="co">#&gt; 0.9651524</span></code></pre></div>
<p>The output indicates that we have a good fit compared to our null model. However, changes in the null model would lead to different estimates of R². For this reason, we also include function <code>simulated_model</code> that produces the quadratic error of a model given some data. We can estimate a new R² using a different null model and estimating its error with the previous function using the equation below: <span class="math display">\[ R^2 = 1 - \frac{\epsilon^2}{\epsilon^2 _0 }\]</span></p>
</div>
</div>
<div id="irregular-sampling-schemes" class="section level1">
<h1>Irregular Sampling Schemes</h1>
<p>Given the complexities and challenges inherent to collecting real-world ecological data, temporal monitoring is often patchy, making irregular sampling schemes common in ecology. Data typically includes one or even several data sets with different sampling schemes. To accommodate the messiness of real-world data, ‘island’ has two functions <code>irregular_single_dataset</code> and <code>irregular_multiple_datasets</code>. Irregular sampling schemes force to alter the way in which we calculate colonization and extinction rates, precluding the use of the algebraic (exact) method for estimating rates. We can still calculate the likelihood of the dynamic model using two methods with different approaches: a <em>heuristic</em> method and a <em>semianalytical</em> method.</p>
<div id="heuristic-vs-semianalytical-methods" class="section level2">
<h2>Heuristic Vs Semianalytical Methods</h2>
<p>The <em>heuristic</em> or <em>semianalytical</em> approaches of calculating rates are implemented in functions <code>irregular_single_dataset</code> and <code>irregular_multiple_dataset</code>, and we can switch between approaches using the argument <code>jacobian</code>.<br />
The <em>heuristic</em> method uses R’s built-in optimization routine, <code>optim</code>, to obtain estimates for the colonization and extinction rates. The function <code>optim</code> uses an implementation of the Nelder-Mead algorithm to find the optimum of the likelihood function. However, <em>heuristic</em> methods do not guarantee finding the global optima of the objective function, and they do not have a mechanism to evaluate how good the optima are for the selected point.<br />
In contrast, the <em>semianalytical</em> method guarantees that the optima calculated is a root of the determinant of the Jacobian matrix of the likelihood function when the algorithm converges. In this package, we call routine <code>multiroot</code> from package <code>rootSolve</code> in order to find the semianalytical optimum value for our likelihood function.<br />
Even though we encourage the use of the Jacobian-based method, it may not always converge. The function will notify possible problems, and we recommend using the heuristic method if difficulties are encountered. One way to find good initial values for the Jacobian-based method is to use the estimates of the heuristic method as a starting point.</p>
</div>
<div id="single-dataset" class="section level2">
<h2>Single dataset</h2>
<p>The function that deals with an irregular sampling scheme in a single data set is called <code>irregular_single_dataset</code>. An example, partially shown below (some samples have been skipped) and similar to the one reproduced earlier, is data of island ST2 in <code>data(simberloff)</code>:</p>
<table>
<thead>
<tr class="header">
<th align="left">Taxa</th>
<th align="right">PRE</th>
<th align="right">21</th>
<th align="right">40</th>
<th align="right">59</th>
<th align="right">231</th>
<th align="right">250</th>
<th align="right">322</th>
<th align="left">Tax. Unit 1</th>
<th align="left">Tax. Unit 2</th>
<th align="left">Genera</th>
<th align="left">Island</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Diradius caribbeana</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Embioptera</td>
<td align="left">Teratembiidae</td>
<td align="left">Diradius</td>
<td align="left">ST2</td>
</tr>
<tr class="even">
<td align="left">Latiblattella n. sp.</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Orthoptera</td>
<td align="left">Blattidae</td>
<td align="left">Latiblattella</td>
<td align="left">ST2</td>
</tr>
<tr class="odd">
<td align="left">Cycloptilum sp.</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Orthoptera</td>
<td align="left">Gryllidae</td>
<td align="left">Cycloptilum</td>
<td align="left">ST2</td>
</tr>
<tr class="even">
<td align="left">Cyrtoxipha sp.</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Orthoptera</td>
<td align="left">Gryllidae</td>
<td align="left">Cyrtoxipha</td>
<td align="left">ST2</td>
</tr>
<tr class="odd">
<td align="left">Tafalisca lurida</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Orthoptera</td>
<td align="left">Gryllidae</td>
<td align="left">Tafalisca</td>
<td align="left">ST2</td>
</tr>
<tr class="even">
<td align="left">Kalotermes joutelli</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">Isoptera</td>
<td align="left">Kalotermitidae</td>
<td align="left">Kalotermes</td>
<td align="left">ST2</td>
</tr>
</tbody>
</table>
<p>Functions <code>irregular_single_dataset</code> as well as <code>irregular_multiple_datasets</code> reproduce all the functionalities of <code>regular_sampling_schemes</code>. Please note that <code>irregular_single_dataset</code> requires numbers for the names of the columns with presence-absence data. The only other difference with the function for the regular sampling schemes is that we need to enter priors for <em>c</em> and <em>e</em>, our colonization and extinction rates, using arguments <code>c =</code> and <code>e =</code>.<br />
Below we illustrate the use of this function with the data for island ST2 of data set <code>simberloff</code>. This data set was published by Simberloff and Wilson (1969). We start by estimating colonization and extinction rates for the whole island.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">st2 &lt;-<span class="st"> </span>simberloff[[<span class="dv">6</span>]]

<span class="co"># Before we begin, it is useful to look at the data for obvious errors.</span>
<span class="kw">head</span>(st2) 
<span class="co">#&gt;                   Taxa PRE 21 40 59 77 94 113 134 149 171 191 211 231 250 322</span>
<span class="co">#&gt; 1  Diradius caribbeana   1  0  0  0  0  0   0   0   0   0   1   0   0   0   0</span>
<span class="co">#&gt; 2 Latiblattella n. sp.   1  0  1  1  1  1   1   1   1   1   1   1   1   1   1</span>
<span class="co">#&gt; 3      Cycloptilum sp.   1  0  0  0  0  0   1   1   1   1   0   0   0   0   0</span>
<span class="co">#&gt; 4       Cyrtoxipha sp.   0  0  0  0  0  0   1   1   1   0   0   0   0   0   0</span>
<span class="co">#&gt; 5     Tafalisca lurida   1  0  0  0  0  1   1   1   1   1   1   1   1   1   1</span>
<span class="co">#&gt; 6  Kalotermes joutelli   0  0  0  1  0  0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;   Tax. Unit 1    Tax. Unit 2        Genera Island</span>
<span class="co">#&gt; 1  Embioptera  Teratembiidae      Diradius    ST2</span>
<span class="co">#&gt; 2  Orthoptera      Blattidae Latiblattella    ST2</span>
<span class="co">#&gt; 3  Orthoptera      Gryllidae   Cycloptilum    ST2</span>
<span class="co">#&gt; 4  Orthoptera      Gryllidae    Cyrtoxipha    ST2</span>
<span class="co">#&gt; 5  Orthoptera      Gryllidae     Tafalisca    ST2</span>
<span class="co">#&gt; 6    Isoptera Kalotermitidae    Kalotermes    ST2</span>

<span class="co"># Presence-absence data is in columns 3 to 16.</span>
rates.st2 &lt;-<span class="st"> </span><span class="kw">irregular_single_dataset</span>(<span class="dt">dataframe =</span> st2, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">16</span>, <span class="dt">c =</span> <span class="fl">0.001</span>, <span class="dt">e =</span> <span class="fl">0.001</span>, <span class="dt">assembly =</span> T, <span class="dt">jacobian =</span> T)
rates.st2
<span class="co">#&gt;            c c_up c_low         e e_up e_low  N      NLL</span>
<span class="co">#&gt; 1 0.00670301   NA    NA 0.0127161   NA    NA 80 457.6403</span>

<span class="co"># We will now estimate rates for different groups in &quot;Tax. Unit 1&quot; with more than 5 species.</span>
rates.groups &lt;-<span class="st"> </span><span class="kw">irregular_single_dataset</span>(<span class="dt">dataframe =</span> st2, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">16</span>, <span class="dt">c =</span> <span class="fl">0.001</span>, <span class="dt">e =</span> <span class="fl">0.001</span>, <span class="dt">column =</span> <span class="st">&quot;Tax. Unit 1&quot;</span>, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">assembly =</span> T, <span class="dt">jacobian =</span> T)
rates.groups
<span class="co">#&gt;         Group           c c_up c_low           e e_up e_low  N       NLL</span>
<span class="co">#&gt; 1     Acarina 0.004820490   NA    NA 0.008007749   NA    NA  8  35.63007</span>
<span class="co">#&gt; 2     Araneae 0.008426681   NA    NA 0.017747947   NA    NA 11  70.27852</span>
<span class="co">#&gt; 3  Coleoptera 0.006089566   NA    NA 0.014810771   NA    NA  8  43.01984</span>
<span class="co">#&gt; 4 Hymenoptera 0.007776273   NA    NA 0.010184661   NA    NA 20 122.89718</span>
<span class="co">#&gt; 5 Lepidoptera 0.007806117   NA    NA 0.012146876   NA    NA  8  49.23273</span>
<span class="co">#&gt; 6  Psocoptera 0.008107215   NA    NA 0.017269065   NA    NA  5  30.16782</span>

<span class="co"># Plotting the results.</span>
<span class="kw">plot</span>(rates.groups[, <span class="dv">2</span>], rates.groups[, <span class="dv">5</span>], <span class="dt">xlab =</span> <span class="st">&quot;Colonization rate (day⁻¹)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Extinction rate (day⁻¹)&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;ST2&quot;</span>)
<span class="kw">points</span>(rates.st2[, <span class="dv">1</span>], rates.st2[, <span class="dv">4</span>], <span class="dt">pch =</span> <span class="dv">4</span>)                        
loc &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">0.004902829</span>, <span class="fl">0.008421634</span>, <span class="fl">0.006021524</span>, <span class="fl">0.007679227</span>, <span class="fl">0.007892796</span>, <span class="fl">0.008025005</span>, <span class="fl">0.006692741</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="fl">0.008578302</span>, <span class="fl">0.017145964</span>, <span class="fl">0.014431104</span>, <span class="fl">0.009668973</span>, <span class="fl">0.011560750</span>, <span class="fl">0.016878929</span>, <span class="fl">0.011553715</span>))

<span class="kw">text</span>(loc, <span class="kw">c</span>(<span class="kw">substr</span>(rates.groups[, <span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">3</span>), <span class="st">&quot;Whole </span><span class="ch">\n</span><span class="st">community&quot;</span>))</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Colonization and extinction rates for the whole invertebrate community or selected taxonomic groups in island ST2." />
<p class="caption">
Colonization and extinction rates for the whole invertebrate community or selected taxonomic groups in island ST2.
</p>
</div>
<p>We can also produce transition probabilities for different time intervals and simulate these time intervals, allowing a more efficient use of processor time and memory. Functions <code>cetotrans</code> and <code>data_generation</code> are optimized to use with irregular time intervals. In the case of function <code>cetotrans</code>, arguments <code>c</code>, <code>e</code> and <code>dt</code> must be vectors of the same length, while for function <code>data_generation</code> arguments <code>transitions</code> and <code>times</code> should have the same number of rows and the same value, respectively. We simulate colonization and extinction dynamics for island ST2 300 times, and we observe that species richness reaches a steady-state after a while.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dts &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(st2)[<span class="dv">4</span><span class="op">:</span><span class="dv">16</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(st2)[<span class="dv">3</span><span class="op">:</span><span class="dv">15</span>])
dts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">21</span>, dts)

tps &lt;-<span class="st"> </span><span class="kw">cetotrans</span>(<span class="dt">c =</span> <span class="kw">rep</span>(rates.st2[[<span class="dv">1</span>]], <span class="kw">length</span>(dts)), <span class="dt">e =</span> <span class="kw">rep</span>(rates.st2[[<span class="dv">4</span>]], <span class="kw">length</span>(dts)), <span class="dt">dt =</span> dts)
tps
<span class="co">#&gt;             T01        T10</span>
<span class="co">#&gt;  [1,] 0.2192933 0.11559563</span>
<span class="co">#&gt;  [2,] 0.2020453 0.10650373</span>
<span class="co">#&gt;  [3,] 0.2020453 0.10650373</span>
<span class="co">#&gt;  [4,] 0.1931669 0.10182363</span>
<span class="co">#&gt;  [5,] 0.1841143 0.09705176</span>
<span class="co">#&gt;  [6,] 0.2020453 0.10650373</span>
<span class="co">#&gt;  [7,] 0.2192933 0.11559563</span>
<span class="co">#&gt;  [8,] 0.1654731 0.08722548</span>
<span class="co">#&gt;  [9,] 0.2276694 0.12001087</span>
<span class="co">#&gt; [10,] 0.2107531 0.11109382</span>
<span class="co">#&gt; [11,] 0.2107531 0.11109382</span>
<span class="co">#&gt; [12,] 0.2107531 0.11109382</span>
<span class="co">#&gt; [13,] 0.2020453 0.10650373</span>
<span class="co">#&gt; [14,] 0.4930516 0.25990123</span>

sims &lt;-<span class="st"> </span><span class="kw">data_generation</span>(<span class="dt">x =</span> <span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">1</span>), <span class="dt">column =</span> <span class="dv">1</span>, <span class="dt">transitions =</span> tps, <span class="dt">iter =</span> <span class="dv">300</span>, <span class="dt">times =</span> <span class="kw">length</span>(dts))
ic &lt;-<span class="st"> </span><span class="kw">apply</span>(sims, <span class="dv">1</span>, quantile, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
ic
<span class="co">#&gt;       [,1]   [,2] [,3]   [,4] [,5]   [,6] [,7] [,8] [,9]  [,10] [,11] [,12]</span>
<span class="co">#&gt; 2.5%     4  8.000   11 14.000   15 18.000   17   18   18 19.000    19    20</span>
<span class="co">#&gt; 97.5%   15 21.525   25 29.525   31 33.525   35   35   36 35.525    35    36</span>
<span class="co">#&gt;       [,13] [,14]</span>
<span class="co">#&gt; 2.5%     19    20</span>
<span class="co">#&gt; 97.5%    36    37</span>

med.st2 &lt;-<span class="st"> </span><span class="kw">apply</span>(sims, <span class="dv">1</span>, median)

days &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">colnames</span>(st2)[<span class="dv">3</span><span class="op">:</span><span class="dv">16</span>]) 

<span class="kw">plot</span>(days, <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">colSums</span>(st2[, <span class="dv">3</span><span class="op">:</span><span class="dv">16</span>])), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="dt">xlab =</span> <span class="st">&quot;Days since defaunation&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Species richness&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;ST2&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)
<span class="kw">lines</span>(days, <span class="kw">c</span>(<span class="dv">0</span>, med.st2), <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(days, <span class="kw">c</span>(<span class="dv">0</span>, ic[<span class="dv">1</span>, ]), <span class="dt">col =</span> <span class="st">&quot;magenta&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(days, <span class="kw">c</span>(<span class="dv">0</span>, ic[<span class="dv">2</span>, ]), <span class="dt">col =</span> <span class="st">&quot;magenta&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Temporal evolution on island ST2. The points connected with lines indicate the observed species richness, while the red dashed line indicates the 95% of the distribution of simulations, and the green dashed line the median richness for 300 simulations." />
<p class="caption">
Temporal evolution on island ST2. The points connected with lines indicate the observed species richness, while the red dashed line indicates the 95% of the distribution of simulations, and the green dashed line the median richness for 300 simulations.
</p>
</div>
</div>
<div id="multiple-datasets" class="section level2">
<h2>Multiple datasets</h2>
<p>Sampling schemes for similar communities can be very different due to multiple reasons usually associated to the challenges of ecological research. The function <code>irregular_multiple_datasets</code> allows us to use data from different sampling schemes and estimate joint parameters for these data sets. In order to use these data sets, they need to comply with the general structure for irregular sampling schemes and they should be combined in a list. The argument <code>list</code> will collate the data sets we want to study jointly and the argument <code>vectorlist</code> must contain the vectors (ordered in time) that indicate where the presence-absence data is located. The remaining arguments work as discussed in earlier sections. Next we estimate colonization and extinction rates for each island and each taxonomic group in the whole dataset <code>simberloff</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates.simberloff &lt;-<span class="st"> </span><span class="kw">irregular_multiple_datasets</span>(<span class="dt">list =</span> simberloff, <span class="dt">vectorlist =</span> <span class="kw">list</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">19</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">16</span>), <span class="dt">c =</span> <span class="fl">0.001</span>, <span class="dt">e =</span> <span class="fl">0.001</span>, <span class="dt">jacobian =</span> T)
rates.islands &lt;-<span class="st"> </span><span class="kw">irregular_multiple_datasets</span>(<span class="dt">list =</span> simberloff, <span class="dt">vectorlist =</span> <span class="kw">list</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">19</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">16</span>), <span class="dt">c =</span> <span class="fl">0.001</span>, <span class="dt">e =</span> <span class="fl">0.001</span>, <span class="dt">column =</span> <span class="st">&quot;Island&quot;</span>, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">jacobian =</span> T)
rates.taxonomy &lt;-<span class="st"> </span><span class="kw">irregular_multiple_datasets</span>(<span class="dt">list =</span> simberloff, <span class="dt">vectorlist =</span> <span class="kw">list</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">19</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">16</span>), <span class="dt">c =</span> <span class="fl">0.0001</span>, <span class="dt">e =</span> <span class="fl">0.0001</span>, <span class="dt">column =</span> <span class="st">&quot;Tax. Unit 1&quot;</span>, <span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">jacobian =</span> T)
rates.simberloff
<span class="co">#&gt;             c c_up c_low          e e_up e_low   N      NLL</span>
<span class="co">#&gt; 1 0.005102348   NA    NA 0.01175197   NA    NA 549 2938.645</span>
rates.islands
<span class="co">#&gt;   Group           c c_up c_low           e e_up e_low   N      NLL</span>
<span class="co">#&gt; 1    E1 0.003849172   NA    NA 0.008577194   NA    NA  54 226.9079</span>
<span class="co">#&gt; 2    E2 0.005353969   NA    NA 0.013019739   NA    NA 119 654.2403</span>
<span class="co">#&gt; 3    E3 0.005637932   NA    NA 0.011374938   NA    NA  92 486.9761</span>
<span class="co">#&gt; 4    E7 0.004133691   NA    NA 0.011507033   NA    NA  99 600.8253</span>
<span class="co">#&gt; 5    E9 0.005261473   NA    NA 0.011595805   NA    NA 105 526.3934</span>
<span class="co">#&gt; 6   ST2 0.006901374   NA    NA 0.012774564   NA    NA  80 433.5353</span>
rates.taxonomy
<span class="co">#&gt;         Group           c c_up c_low           e e_up e_low   N      NLL</span>
<span class="co">#&gt; 1     Acarina 0.005007757   NA    NA 0.010790814   NA    NA  48 240.7149</span>
<span class="co">#&gt; 2     Araneae 0.005658833   NA    NA 0.016369729   NA    NA  85 488.8871</span>
<span class="co">#&gt; 3  Coleoptera 0.004985066   NA    NA 0.011884045   NA    NA  65 349.9689</span>
<span class="co">#&gt; 4   Hemiptera 0.006196764   NA    NA 0.019892102   NA    NA  34 185.8024</span>
<span class="co">#&gt; 5 Hymenoptera 0.004933051   NA    NA 0.011527283   NA    NA 131 689.1720</span>
<span class="co">#&gt; 6 Lepidoptera 0.005971425   NA    NA 0.007636927   NA    NA  44 241.2960</span>
<span class="co">#&gt; 7  Orthoptera 0.005429715   NA    NA 0.005220060   NA    NA  24 122.8997</span>
<span class="co">#&gt; 8  Psocoptera 0.005809177   NA    NA 0.016437311   NA    NA  46 267.1539</span>

<span class="kw">plot</span>(rates.taxonomy[, <span class="dv">2</span>], rates.taxonomy[, <span class="dv">5</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">0034</span>, .<span class="dv">0074</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">0025</span>, .<span class="dv">0225</span>), <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Simberloff dataset&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Colonization rate (day⁻¹)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Extinction rate (day⁻¹)&quot;</span>)
<span class="kw">points</span>(rates.islands[, <span class="dv">2</span>], rates.islands[, <span class="dv">5</span>], <span class="dt">pch =</span> <span class="dv">4</span>)
<span class="kw">points</span>(rates.simberloff[, <span class="dv">1</span>], rates.simberloff[, <span class="dv">4</span>], <span class="dt">pch =</span> <span class="dv">3</span>)

locs &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">0.005136858</span>, <span class="fl">0.003858476</span>, <span class="fl">0.005435459</span>, <span class="fl">0.005724728</span>, <span class="fl">0.004026439</span>, <span class="fl">0.005379471</span>, <span class="fl">0.006919129</span>, <span class="fl">0.005015552</span>, <span class="fl">0.005594090</span>, <span class="fl">0.004912908</span>, <span class="fl">0.006303266</span>, <span class="fl">0.004722939</span>, <span class="fl">0.006069984</span>, <span class="fl">0.005435459</span>, <span class="fl">0.005892691</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="fl">0.01074532</span>, <span class="fl">0.007403081</span>, <span class="fl">0.014011605</span>, <span class="fl">0.010289563</span>, <span class="fl">0.012644324</span>, <span class="fl">0.010593403</span>, <span class="fl">0.011353003</span>, <span class="fl">0.009985722</span>, <span class="fl">0.017429807</span>, <span class="fl">0.012872204</span>, <span class="fl">0.018645168</span>, <span class="fl">0.011201083</span>, <span class="fl">0.006415600</span>, <span class="fl">0.004212758</span>, <span class="fl">0.015454846</span>))
<span class="kw">text</span>(locs, <span class="kw">c</span>(<span class="st">&quot;TIB&quot;</span>, <span class="kw">as.character</span>(rates.islands<span class="op">$</span>Group), <span class="kw">substr</span>(rates.taxonomy[, <span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">3</span>)), 
     <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;magenta&quot;</span>, <span class="dv">6</span>), <span class="kw">rep</span>(<span class="st">&quot;green&quot;</span>, <span class="dv">8</span>)))</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Colonization and extinction rates for the data from Simberloff (1969) on experimental island zoogeography. In green, some of the groups studied, in magenta the different islands." />
<p class="caption">
Colonization and extinction rates for the data from Simberloff (1969) on experimental island zoogeography. In green, some of the groups studied, in magenta the different islands.
</p>
</div>
<p>The rates obtained indicate differences among islands, specially in colonization, while the different taxonomic groups show different rates.</p>
</div>
</div>
<div id="a-short-example" class="section level1">
<h1>A short example</h1>
<p>In this section, we will reproduce, step-by-step, some of the results presented in the article by Alonso <em>et al.</em> (2015), on the recolonization process of a coral reef fish community in the Lakshadweep Archipelago after a coral mass mortality event. This article shows that higher trophic guilds suffer increased rates of extinction even in the absence of targeted fishing.<br />
The article estimated colonization and extinction rates for 4 competing models to explain the dynamics of the coral fish community, performed model selection among those models and simulated the dynamics of different trophic guilds in each island. The four models were: A, the different guilds in the three sampled islands behaved as a single community; B, each island had a different dynamics; C, each guild had a different dynamics, but did not vary between islands; and D, each guild had a different dynamics in each island. Below, we reproduce part of Table 1 of the article, showing the model selection procedure, Figure 3, showing the transition probabilities found by the best model, and a plot for the temporal evolution of corallivorous fishes in Agatti atoll, included in the original article in Figure 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(alonso15)
<span class="kw">head</span>(alonso15[[<span class="dv">2</span>]]) <span class="co"># Examine the data</span>
<span class="co">#&gt;                   Species Trophic.Level Kd.2000 Kd.2001 Kd.2002 Kd.2003 Kd.2010</span>
<span class="co">#&gt; 1 Acanthurus auranticavus          &lt;NA&gt;       1       1       1       1       1</span>
<span class="co">#&gt; 2 Acanthurus leucosternon             2       1       1       1       1       1</span>
<span class="co">#&gt; 3     Acanthurus lineatus             2       1       1       1       1       1</span>
<span class="co">#&gt; 4  Acanthurus nigrofuscus             2       1       1       1       1       1</span>
<span class="co">#&gt; 5   Acanthurus triostegus          2,78       1       1       1       1       1</span>
<span class="co">#&gt; 6 Acanthurus xanthopterus          2,87       0       0       0       1       1</span>
<span class="co">#&gt;   Kd.2011        Guild</span>
<span class="co">#&gt; 1       1 Algal Feeder</span>
<span class="co">#&gt; 2       1 Algal Feeder</span>
<span class="co">#&gt; 3       1 Algal Feeder</span>
<span class="co">#&gt; 4       1 Algal Feeder</span>
<span class="co">#&gt; 5       1 Algal Feeder</span>
<span class="co">#&gt; 6       1 Algal Feeder</span>

<span class="co"># To begin, we calculate rates for each island (model B), and for each group in each island (model D).</span>
rates.aga &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> alonso15[[<span class="dv">1</span>]], <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)
rates.kad &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> alonso15[[<span class="dv">2</span>]], <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)
rates.kav &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> alonso15[[<span class="dv">3</span>]], <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)

ModelB &lt;-<span class="st"> </span>rates.aga<span class="op">$</span>NLL <span class="op">+</span><span class="st"> </span>rates.kad<span class="op">$</span>NLL <span class="op">+</span><span class="st"> </span>rates.kav<span class="op">$</span>NLL 


rates.aga.guild &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> alonso15[[<span class="dv">1</span>]], <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">level =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">1</span>)
rates.kad.guild &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> alonso15[[<span class="dv">2</span>]], <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">level =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">1</span>)
rates.kav.guild &lt;-<span class="st"> </span><span class="kw">regular_sampling_scheme</span>(<span class="dt">x =</span> alonso15[[<span class="dv">3</span>]], <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">level =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">1</span>)

ModelD &lt;-<span class="st"> </span><span class="kw">sum</span>(rates.aga.guild<span class="op">$</span>NLL) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(rates.kad.guild<span class="op">$</span>NLL) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(rates.kav.guild<span class="op">$</span>NLL)

<span class="co"># Next, we calculate rates using the function irregular_multiple_datasets. We need to first change the colnames of the columns with data.</span>

<span class="kw">colnames</span>(alonso15[[<span class="dv">1</span>]])[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="dv">2000</span><span class="op">:</span><span class="dv">2003</span>
<span class="kw">colnames</span>(alonso15[[<span class="dv">2</span>]])[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="dv">2000</span><span class="op">:</span><span class="dv">2003</span>
<span class="kw">colnames</span>(alonso15[[<span class="dv">3</span>]])[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">2001</span><span class="op">:</span><span class="dv">2003</span>

rates.lak &lt;-<span class="st"> </span><span class="kw">irregular_multiple_datasets</span>(<span class="dt">list =</span> alonso15, <span class="dt">vectorlist =</span> <span class="kw">list</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">c =</span> <span class="fl">0.1</span>, <span class="dt">e =</span> <span class="fl">0.1</span>, <span class="dt">jacobian =</span> T, <span class="dt">CI =</span> T)

rates.guild &lt;-<span class="st"> </span><span class="kw">irregular_multiple_datasets</span>(<span class="dt">list =</span> alonso15, <span class="dt">vectorlist =</span> <span class="kw">list</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">c =</span> <span class="fl">0.1</span>, <span class="dt">e =</span> <span class="fl">0.1</span>, <span class="dt">jacobian =</span> T, <span class="dt">column =</span> <span class="st">&quot;Guild&quot;</span>, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">CI =</span> T)

<span class="co"># We can now follow the model selection procedure used in the article.</span>
ModelA &lt;-<span class="st"> </span>rates.lak<span class="op">$</span>NLL
ModelC &lt;-<span class="st"> </span><span class="kw">sum</span>(rates.guild<span class="op">$</span>NLL)

NLL &lt;-<span class="st"> </span><span class="kw">c</span>(ModelA, ModelB, ModelC, ModelD)
NLL
<span class="co">#&gt; [1] 742.3037 741.1601 725.4704 710.7865</span>

Parameters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">14</span>, <span class="dv">42</span>)
N &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1248</span>, <span class="dv">4</span>)

AIC &lt;-<span class="st"> </span><span class="kw">akaikeic</span>(<span class="dt">NLL =</span> NLL, <span class="dt">k =</span> Parameters)
AICc &lt;-<span class="st"> </span><span class="kw">akaikeicc</span>(<span class="dt">NLL =</span> NLL, <span class="dt">k =</span> Parameters, <span class="dt">n =</span> <span class="dv">1248</span>)

Table1 &lt;-<span class="st"> </span><span class="kw">weight_of_evidence</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">Model =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="dt">AICc =</span> AICc))
Table1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(Table1, AIC, AICc, NLL, Parameters, N)
knitr<span class="op">::</span><span class="kw">kable</span>(Table1)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">IncAIC</th>
<th align="right">w</th>
<th align="right">AIC</th>
<th align="right">AICc</th>
<th align="right">NLL</th>
<th align="right">Parameters</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">9.335557</td>
<td align="right">0.0093009</td>
<td align="right">1488.607</td>
<td align="right">1488.617</td>
<td align="right">742.3037</td>
<td align="right">2</td>
<td align="right">1248</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">15.106378</td>
<td align="right">0.0005193</td>
<td align="right">1494.320</td>
<td align="right">1494.388</td>
<td align="right">741.1601</td>
<td align="right">6</td>
<td align="right">1248</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">0.000000</td>
<td align="right">0.9901794</td>
<td align="right">1478.941</td>
<td align="right">1479.282</td>
<td align="right">725.4704</td>
<td align="right">14</td>
<td align="right">1248</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">29.289027</td>
<td align="right">0.0000004</td>
<td align="right">1505.573</td>
<td align="right">1508.571</td>
<td align="right">710.7865</td>
<td align="right">42</td>
<td align="right">1248</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The following steps are used to reproduce Figure 3 in Alonso *et al* (2015).</span>
rates.guild
<span class="co">#&gt;               Group         c      c_up     c_low         e      e_up     e_low</span>
<span class="co">#&gt; 1      Algal Feeder 0.6314581 0.8750604 0.4396526 0.1913754 0.2873993 0.1198905</span>
<span class="co">#&gt; 2       Corallivore 0.4505997 0.6573846 0.2938969 0.2743163 0.4345424 0.1598409</span>
<span class="co">#&gt; 3 Macroinvertivore  0.5286944 0.6873453 0.3977289 0.4329315 0.5721428 0.3191255</span>
<span class="co">#&gt; 4  Microinvertivore 0.4823432 0.6950086 0.3201004 0.5565499 0.8014445 0.3698255</span>
<span class="co">#&gt; 5         Omnivore  0.5107695 0.8562513 0.2773004 0.2907457 0.5674376 0.1238472</span>
<span class="co">#&gt; 6        Piscivore  0.6428574 0.8878366 0.4518301 0.6607665 0.9631957 0.4321006</span>
<span class="co">#&gt; 7   Zooplanktivore  0.7924913 1.1952252 0.4994883 0.2661351 0.4598341 0.1371437</span>
<span class="co">#&gt;     N       NLL</span>
<span class="co">#&gt; 1  90 116.33150</span>
<span class="co">#&gt; 2  60  89.39827</span>
<span class="co">#&gt; 3 123 201.79017</span>
<span class="co">#&gt; 4  63 105.29037</span>
<span class="co">#&gt; 5  27  41.50041</span>
<span class="co">#&gt; 6  63 110.06134</span>
<span class="co">#&gt; 7  42  61.09837</span>

<span class="co"># transform rates into transition probabilities.</span>
tps &lt;-<span class="st"> </span><span class="kw">cetotrans</span>(<span class="dt">c =</span> rates.guild<span class="op">$</span>c, <span class="dt">e =</span> rates.guild<span class="op">$</span>e)

<span class="kw">plot</span>(tps[, <span class="dv">2</span>], tps[, <span class="dv">1</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Colonization probability&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Extinction probability&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Lakshadweep guilds&quot;</span>)
<span class="kw">text</span>(tps[, <span class="dv">2</span>], tps[, <span class="dv">1</span>], <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;Z&quot;</span>))
<span class="kw">text</span>(<span class="fl">0.07</span>, <span class="fl">0.25</span>, <span class="st">&quot;Trophic level&quot;</span>, <span class="dt">srt =</span> <span class="dv">90</span>, <span class="dt">col =</span> <span class="st">&quot;magenta&quot;</span>)
<span class="kw">arrows</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="dt">code =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Colonization and extinction probabilities by guild within the coral reef fish community in the Lakshadweep Archipelago, India. Algal Feeders (A), Omnivores (O), Corallivores (C), Zooplanktivores (Z), Micro-invertivores (m), Macro-invertivores (M), and Piscivores (P)." />
<p class="caption">Colonization and extinction probabilities by guild within the coral reef fish community in the Lakshadweep Archipelago, India. Algal Feeders (A), Omnivores (O), Corallivores (C), Zooplanktivores (Z), Micro-invertivores (m), Macro-invertivores (M), and Piscivores (P).</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rates.aga.guild
<span class="co">#&gt;               Group         c c_up c_low         e e_up e_low  N      NLL</span>
<span class="co">#&gt; 1      Algal Feeder 0.5058664   NA    NA 0.2360710   NA    NA 30 49.00071</span>
<span class="co">#&gt; 2       Corallivore 0.5902927   NA    NA 0.2459553   NA    NA 20 33.70719</span>
<span class="co">#&gt; 3 Macroinvertivore  0.3438327   NA    NA 0.3625524   NA    NA 41 69.42637</span>
<span class="co">#&gt; 4  Microinvertivore 0.5865863   NA    NA 0.7502420   NA    NA 21 41.07112</span>
<span class="co">#&gt; 5         Omnivore  0.9037842   NA    NA 0.2397795   NA    NA  9 14.71404</span>
<span class="co">#&gt; 6        Piscivore  0.6161308   NA    NA 0.7701635   NA    NA 21 41.12469</span>
<span class="co">#&gt; 7   Zooplanktivore  0.8724753   NA    NA 0.4800701   NA    NA 14 26.87099</span>

tps &lt;-<span class="st"> </span><span class="kw">cetotrans</span>(<span class="dt">c =</span> rates.aga.guild[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dt">e =</span> rates.aga.guild[<span class="dv">2</span>, <span class="dv">5</span>])

cor.agatti &lt;-<span class="st"> </span>alonso15[[<span class="dv">1</span>]][alonso15[[<span class="dv">1</span>]]<span class="op">$</span>Guild <span class="op">==</span><span class="st"> &quot;Corallivore&quot;</span>, ]
richness &lt;-<span class="st"> </span><span class="kw">colSums</span>(cor.agatti[, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>])
richness
<span class="co">#&gt;   2000   2001   2002   2003 A.2010 A.2011 </span>
<span class="co">#&gt;      7     11     12     14     14     18</span>

sims &lt;-<span class="st"> </span><span class="kw">data_generation</span>(<span class="dt">x =</span> cor.agatti, <span class="dt">column =</span> <span class="dv">3</span>, <span class="dt">transitions =</span> tps, <span class="dt">iter =</span> <span class="dv">300</span>, <span class="dt">times =</span> <span class="dv">11</span>)
sims.ic &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> sims, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> quantile, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))

<span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2003</span>, <span class="dv">2010</span>, <span class="dv">2011</span>), richness, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">21</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time (Year)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Corallivore/AGATTI&quot;</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2011</span>), <span class="kw">c</span>(<span class="dv">7</span>, sims.ic[<span class="dv">1</span>, ]), <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2011</span>), <span class="kw">c</span>(<span class="dv">7</span>, sims.ic[<span class="dv">2</span>, ]), <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Temporal evolution of species richness of corallivores in Agatti atoll, according to model D. In red, the observed species richness, while the black dashed lines represent 95% of the distribution of 300 simulations with the estimated dynamics." />
<p class="caption">Temporal evolution of species richness of corallivores in Agatti atoll, according to model D. In red, the observed species richness, while the black dashed lines represent 95% of the distribution of 300 simulations with the estimated dynamics.</p>
</div>
</div>
<div id="environmental-fit" class="section level1">
<h1>Environmental fit</h1>
<p>Apart from several biotic factors (e.g.. the presence of top predators or the abundance of primary producers), the number of species in a community can also be influenced by several abiotic factors (e.g.. temperature or rainfall) - referred to as environmental covariates. The package <code>island</code> includes functions <code>all_environmental_fit</code>, <code>greedy_environmental_fit</code>, <code>custom_environmental_fit</code> and <code>rates_calculator</code> to analyze the influence of environmental covariates on the colonization and extinction dynamics of ecological communities. The functions assume a linear functional response for environmental covariates, <span class="math display">\[ c_t = \alpha_0 + \sum_{i=1}^F \alpha_{i} Y_{it}, \quad e_t = \beta_0 + \sum_{i=1}^F \beta_{i} Y_{it},\]</span> where <span class="math inline">\(Y_{it}\)</span> is the value of the <span class="math inline">\(i\)</span>-th environmental covariate (<span class="math inline">\(i=1,\dots,F\)</span>) at time <span class="math inline">\(t\)</span>, since it is the simplest way to build this dependency into colonization and extinction rates.<br />
We employ R expressions in these functions. An <code>expression</code> is an R object, frequently a call, symbol or constant, that has to be evaluated prior to its use. We have minimized the use of expressions to make certain function calls easier to understand. However we make use of them internally and provide function <code>custom_environmental_fit</code> that needs two expressions in order to hone the results from <code>all_environmental_fit</code> and <code>greedy_environmental_fit</code> as well as developing custom dependencies with environmental covariates that can be specified by advanced users.<br />
All three functions for environmental fit need a single argument <code>dataset</code> with the same structure as the one for irregular schemes and an argument <code>vector</code> indicating the columns containing presence absence data. In addition, all three functions need another <code>data.frame</code> with related environmental covariates in columns. The names of these columns have to be specified to functions <code>all_environmental_fit</code> and <code>greedy_environmental_fit</code> with the argument <code>env</code>. These two functions also need arguments <code>c</code>, <code>e</code> and <code>aic</code>, this is, tentative values for colonization and extinction rates and a tentative AIC value for the model. In practice, this AIC value should be chosen very large (of the order of 10⁸ but this depends on the size of the data set). The difference between <code>all_environmental_fit</code> and <code>greedy_environmental_fit</code> is that the latter employs a greedy algorithm that sequentially adds environmental covariates, one at a time, to the previously best set (using AIC), i. e., the algorithm finds first the best environmental covariate and then the best combination with two covariates including the previously selected, and so forth until AIC does not justify the addition of new covariates. In contrast <code>all_environmental_fit</code> tries all combinations of environmental variables, starting with the minimum number of environmental covariates to the maximum. Since the number of combinations rapidly becomes unmanageable, this method is not recommended except when we have few environmental variables.<br />
We illustrate the use of these functions using <code>data(idaho)</code>. This is a long-term time series of a mapped plant community in Dubois, Idaho (USA). The plant community of a sagebrush steppe was mapped and identified from 1923 to 1973, using permanent 1-m² quadrats, and precipitation, mean temperature and snowfall were measured monthly (we added the annual mean for each one). The data included in this package is a sample of the full data set corresponding to several quadrats surveyed from 1932 to 1955 with some gaps. The following code explores the relation of this plant community with total annual precipitation and mean monthly temperature.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(idaho)
df &lt;-<span class="st"> </span>idaho[[<span class="dv">1</span>]]
env &lt;-<span class="st"> </span>idaho[[<span class="dv">2</span>]]

<span class="co"># Examine the colnames.</span>
<span class="kw">colnames</span>(df)
<span class="co">#&gt;  [1] &quot;quad&quot;    &quot;species&quot; &quot;32&quot;      &quot;33&quot;      &quot;34&quot;      &quot;35&quot;      &quot;36&quot;     </span>
<span class="co">#&gt;  [8] &quot;37&quot;      &quot;38&quot;      &quot;39&quot;      &quot;40&quot;      &quot;41&quot;      &quot;42&quot;      &quot;45&quot;     </span>
<span class="co">#&gt; [15] &quot;46&quot;      &quot;47&quot;      &quot;49&quot;      &quot;50&quot;      &quot;51&quot;      &quot;52&quot;      &quot;54&quot;     </span>
<span class="co">#&gt; [22] &quot;55&quot;      &quot;56&quot;</span>
<span class="kw">colnames</span>(env)
<span class="co">#&gt;  [1] &quot;YEAR&quot;        &quot;JAN.ppt&quot;     &quot;FEB.ppt&quot;     &quot;MAR.ppt&quot;     &quot;APR.ppt&quot;    </span>
<span class="co">#&gt;  [6] &quot;MAY.ppt&quot;     &quot;JUN.ppt&quot;     &quot;JUL.ppt&quot;     &quot;AUG.ppt&quot;     &quot;SEP.ppt&quot;    </span>
<span class="co">#&gt; [11] &quot;OCT.ppt&quot;     &quot;NOV.ppt&quot;     &quot;DEC.ppt&quot;     &quot;TOTAL.ppt&quot;   &quot;JAN.temp&quot;   </span>
<span class="co">#&gt; [16] &quot;FEB.temp&quot;    &quot;MAR.temp&quot;    &quot;APR.temp&quot;    &quot;MAY.temp&quot;    &quot;JUN.temp&quot;   </span>
<span class="co">#&gt; [21] &quot;JUL.temp&quot;    &quot;AUG.temp&quot;    &quot;SEP.temp&quot;    &quot;OCT.temp&quot;    &quot;NOV.temp&quot;   </span>
<span class="co">#&gt; [26] &quot;DEC.temp&quot;    &quot;ANNUAL.temp&quot; &quot;JAN.snow&quot;    &quot;FEB.snow&quot;    &quot;MAR.snow&quot;   </span>
<span class="co">#&gt; [31] &quot;APR.snow&quot;    &quot;MAY.snow&quot;    &quot;JUN.snow&quot;    &quot;JUL.snow&quot;    &quot;AUG.snow&quot;   </span>
<span class="co">#&gt; [36] &quot;SEP.snow&quot;    &quot;OCT.snow&quot;    &quot;NOV.snow&quot;    &quot;DEC.snow&quot;    &quot;TOTAL.snow&quot;</span>

<span class="co"># Estimate the influence of temperature and precipitation on colonization and extinction dynamics. We first include the call to all_environmental_fit but we do not run it because of computation limits. We then use the greedy algorithm to find a good dependency.</span>

envfit &lt;-<span class="st"> </span><span class="kw">greedy_environmental_fit</span>(<span class="dt">dataset =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">23</span>, <span class="dt">env =</span> <span class="kw">c</span>(<span class="st">&quot;env$TOTAL.ppt&quot;</span>, <span class="st">&quot;env$ANNUAL.temp&quot;</span>), <span class="dt">c =</span> <span class="fl">0.13</span>, <span class="dt">e =</span> <span class="fl">0.19</span>, <span class="dt">aic =</span> <span class="dv">100000</span>)
envfit
<span class="co">#&gt; $Colonization</span>
<span class="co">#&gt; expression(params[1] * env$TOTAL.ppt[i] + params[3])</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Extinction</span>
<span class="co">#&gt; expression(params[2] * env$ANNUAL.temp[i] + params[4])</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results</span>
<span class="co">#&gt; $Results$par</span>
<span class="co">#&gt; [1] -0.00497925 -0.01729602  0.19006501  0.93486956</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$value</span>
<span class="co">#&gt; [1] -1874.859</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$counts</span>
<span class="co">#&gt; function gradient </span>
<span class="co">#&gt;      215       NA </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$convergence</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$message</span>
<span class="co">#&gt; NULL</span>

<span class="kw">all_environmental_fit</span>(<span class="dt">dataset =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">23</span>, <span class="dt">env =</span> <span class="kw">c</span>(<span class="st">&quot;env$TOTAL.ppt&quot;</span>, <span class="st">&quot;env$ANNUAL.temp&quot;</span>), <span class="dt">c =</span> <span class="fl">0.13</span>, <span class="dt">e =</span> <span class="fl">0.19</span>, <span class="dt">aic =</span> <span class="dv">100000</span>) 
<span class="co">#&gt; $Colonization</span>
<span class="co">#&gt; expression(params[1] * env$TOTAL.ppt[i] + params[3])</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Extinction</span>
<span class="co">#&gt; expression(params[2] * env$ANNUAL.temp[i] + params[4])</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results</span>
<span class="co">#&gt; $Results$par</span>
<span class="co">#&gt; [1] -0.00497925 -0.01729602  0.19006501  0.93486956</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$value</span>
<span class="co">#&gt; [1] -1874.859</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$counts</span>
<span class="co">#&gt; function gradient </span>
<span class="co">#&gt;      215       NA </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$convergence</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Results$message</span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>The greedy algorithm identified a model that included precipitation in the expression for colonization and temperature in the expression for extinction. The output of the function is a list that indicates that its first component is the expression for the colonization, the second one is the expression for the extinction, and the third one is the result of the optimizer for these expressions; in this case, the output of the function indicates that the colonization rate depends on precipitation (with a coefficient of -0.00497925 and an intercept of 0.19006501), the extinction rate depends on temperature (with a coefficient of -0.01729602 and an intercept of 0.93486956), and it has a log-likelihood of 1874.859 that was found after 215 calls to the corresponding likelihood function. This result was backed by function <code>all_environmental_fit</code>, that found the same dependency with the environmental covariates.<br />
We will now use the function <code>custom_environmental_fit</code> to demonstrate its use and improve the result we found earlier. Besides arguments <code>dataset</code> and <code>vector</code>, this function requires an argument <code>params</code> that corresponds to the parameters estimated for expressions <code>c_expression</code> and <code>e_expression</code>, for colonization and extinction. Next, we use <code>rates_calculator</code>, that uses arguments <code>params</code>, <code>c_expression</code> and <code>e_expression</code> as in the previous function plus argument <code>t</code> that indicates the number of colonization and extinction rates needed. This function calculates the actual rates at each time in order to be able to simulate the dynamics of the colonization and extinction process resulting from these parameters. Please note that these rates have dimensions of time⁻¹, so when converting rates to transition probabilities we have to indicate the interval of time between samples for each rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">custom_environmental_fit</span>(<span class="dt">dataset =</span> df, <span class="dt">vector =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">23</span>, <span class="dt">params =</span> envfit<span class="op">$</span>Results<span class="op">$</span>par, <span class="dt">c_expression =</span> envfit<span class="op">$</span>Colonization, <span class="dt">e_expression =</span> envfit<span class="op">$</span>Extinction)
<span class="co">#&gt; $par</span>
<span class="co">#&gt; [1] -0.004973345 -0.017281488  0.190021313  0.934197043</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] -1874.859</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts</span>
<span class="co">#&gt; function gradient </span>
<span class="co">#&gt;       97       NA </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $convergence</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $message</span>
<span class="co">#&gt; NULL</span>

rates.env &lt;-<span class="st"> </span><span class="kw">rates_calculator</span>(<span class="dt">params =</span> envfit<span class="op">$</span>Results<span class="op">$</span>par, <span class="dt">c_expression =</span>  envfit<span class="op">$</span>Colonization, <span class="dt">e_expression =</span> envfit<span class="op">$</span>Extinction, <span class="dt">t =</span> <span class="dv">21</span>)
<span class="kw">head</span>(rates.env)
<span class="co">#&gt;              c          e</span>
<span class="co">#&gt; [1,] 0.1398742 0.23293924</span>
<span class="co">#&gt; [2,] 0.1448036 0.19041984</span>
<span class="co">#&gt; [3,] 0.1491356 0.08866157</span>
<span class="co">#&gt; [4,] 0.1445547 0.18681650</span>
<span class="co">#&gt; [5,] 0.1462476 0.17917743</span>
<span class="co">#&gt; [6,] 0.1460484 0.21189574</span>

dts &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(df)[<span class="dv">4</span><span class="op">:</span><span class="dv">23</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(df)[<span class="dv">3</span><span class="op">:</span><span class="dv">22</span>])
dts
<span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 3 1 1 2 1 1 1 2 1 1</span>

tps &lt;-<span class="st"> </span><span class="kw">cetotrans</span>(<span class="dt">c =</span> rates.env[<span class="op">-</span><span class="dv">21</span>, <span class="dv">1</span>], <span class="dt">e =</span> rates.env[<span class="op">-</span><span class="dv">21</span>, <span class="dv">2</span>], <span class="dt">dt =</span> dts)
sims &lt;-<span class="st"> </span><span class="kw">data_generation</span>(<span class="dt">x =</span> df, <span class="dt">column =</span> <span class="dv">3</span>, <span class="dt">transitions =</span> tps, <span class="dt">iter =</span> <span class="dv">100</span>, <span class="dt">times =</span> <span class="dv">20</span>)
sims.ic &lt;-<span class="st"> </span><span class="kw">apply</span>(sims, <span class="dv">1</span>, quantile, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
med.ida &lt;-<span class="st"> </span><span class="kw">apply</span>(sims, <span class="dv">1</span>, quantile, <span class="dt">probs =</span> .<span class="dv">5</span>)
sims.ic
<span class="co">#&gt;         [,1]   [,2]   [,3]    [,4]   [,5]    [,6]    [,7] [,8]    [,9]  [,10]</span>
<span class="co">#&gt; 2.5%  52.950 60.950 73.475  75.475  79.95  80.000  74.475   79  80.000  76.95</span>
<span class="co">#&gt; 97.5% 73.525 84.525 98.000 101.000 106.05 104.525 101.050  105 102.525 106.00</span>
<span class="co">#&gt;         [,11]  [,12]  [,13]   [,14]  [,15] [,16] [,17]  [,18]   [,19]  [,20]</span>
<span class="co">#&gt; 2.5%   74.475 70.000 71.475  75.425  75.95 75.00    72  71.00  74.475  73.00</span>
<span class="co">#&gt; 97.5% 100.575 94.525 97.000 101.525 104.05 99.05    98 100.05 106.525 100.05</span>

days &lt;-<span class="st"> </span><span class="dv">1900</span> <span class="op">+</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(df)[<span class="dv">3</span><span class="op">:</span><span class="dv">23</span>])


<span class="kw">plot</span>(days, <span class="kw">colSums</span>(df[, <span class="dv">3</span><span class="op">:</span><span class="dv">23</span>]), <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">115</span>), <span class="dt">pch =</span> <span class="dv">4</span>, <span class="dt">ylab =</span> <span class="st">&quot;Accumulated species richness&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Sagebrush steppe Dubois, ID, USA&quot;</span>)
<span class="kw">lines</span>(days, <span class="kw">c</span>(<span class="dv">57</span>, sims.ic[<span class="dv">1</span>, ]), <span class="dt">col =</span> <span class="st">&quot;magenta&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(days, <span class="kw">c</span>(<span class="dv">57</span>, sims.ic[<span class="dv">2</span>, ]), <span class="dt">col =</span> <span class="st">&quot;magenta&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(days, <span class="kw">c</span>(<span class="dv">57</span>, med.ida), <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Temporal evolution of species richness in a plant community. The points connected with lines indicate the observed species richness, while the red dashed line indicates the 95% of the distribution of simulations, and the green dashed line the median richness for 300 simulations." />
<p class="caption">
Temporal evolution of species richness in a plant community. The points connected with lines indicate the observed species richness, while the red dashed line indicates the 95% of the distribution of simulations, and the green dashed line the median richness for 300 simulations.
</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>This vignette comprehensively illustrates most of the functionality of the package <code>island</code>. This package allows the estimation of colonization and extinction rates for whole communities or groups of species under two basic assumptions: <em>species independence</em> and <em>species equivalence</em>. It allows the user to employ typically messy ecological monitoring data with a variety of sampling schemes. It also enables explorations of the influence of environmental variables on colonization and extinction rates, and helps identify the best model explaining data using a model selection procedure. Finally, it simulates the dynamics of estimated parameters for simple stochastic models of island biogeography. For more details, take a look at the other vignettes of the package.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
